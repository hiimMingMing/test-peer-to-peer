<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Controller (Phone)</title>
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; margin: 40px; }
    button {
      font-size: 1.5em; margin: 10px; padding: 15px 25px;
      border-radius: 10px; border: none; background: #2196F3; color: white;
    }
  </style>
</head>
<body>
  <h1>📲 Điều khiển</h1>
  <div id="status">⏳ Đang kết nối...</div>
  <br/>
  <button onclick="send('left')">⬅️ Trái</button>
  <button onclick="send('right')">➡️ Phải</button>
  <button onclick="send('jump')">🕴️ Nhảy</button>

  <script>
    const peerId = new URLSearchParams(location.search).get("peerId");
    const peer = new Peer();

    let conn;

    peer.on('open', () => {
      conn = peer.connect(peerId);

      conn.on('open', () => {
        document.getElementById('status').innerText = "✅ Đã kết nối tới " + peerId;
      });

      conn.on('error', err => {
        document.getElementById('status').innerText = "❌ Lỗi kết nối!";
        console.error(err);
      });
    });

    function send(action) {
      if (conn && conn.open) {
        conn.send({ action });
        console.log("📤 Gửi:", action);
      }
    }
  </script>
</body>
</html>
